import{A as L}from"./AdminLayout.0d5938d1.js";import{d as U,L as O,P as B,r as v,_ as P,m as f,f as o,o as _,g as S,w as s,a as $,e as b,q as k,j as g,s as C,c as a,k as z,t as M}from"./index.55602709.js";function R(e,t){const u=new FileReader;u.addEventListener("load",()=>t(u.result)),u.readAsDataURL(e)}const I=U({components:{LoadingOutlined:O,PlusOutlined:B},setup(){const e=v([]),t=v(!1),u=v("");return{fileList:e,loading:t,imageUrl:u,handleChange:m=>{if(m.file.status==="uploading"){t.value=!0;return}m.file.status==="done"&&R(m.file.originFileObj,n=>{u.value=n,t.value=!1}),m.file.status==="error"&&(t.value=!1,f.error("upload error"))},beforeUpload:m=>{const n=m.type==="image/jpeg"||m.type==="image/png";n||f.error("You can only upload JPG file!");const r=m.size/1024/1024<2;return r||f.error("Image must smaller than 2MB!"),n&&r}}}}),N=["src"],K={key:1},F=b("div",{class:"ant-upload-text"},"Upload",-1);function V(e,t,u,y,w,m){const n=o("loading-outlined"),r=o("plus-outlined"),i=o("a-upload");return _(),S(i,{"file-list":e.fileList,"onUpdate:file-list":t[0]||(t[0]=d=>e.fileList=d),name:"avatar","list-type":"picture-card",class:"avatar-uploader","show-upload-list":!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76","before-upload":e.beforeUpload,onChange:e.handleChange},{default:s(()=>[e.imageUrl?(_(),$("img",{key:0,src:e.imageUrl,alt:"avatar"},null,8,N)):(_(),$("div",K,[e.loading?(_(),S(n,{key:0})):(_(),S(r,{key:1})),F]))]),_:1},8,["file-list","before-upload","onChange"])}const T=P(I,[["render",V]]),j=U({setup(){const e=v(!1);return{formState:k({client_id:0,first_name:null,last_name:null,email:null,city:null,state:null,zip:null,address1:null,address2:null,phone:null,role:null}),loading:e}},data(){return{roles:[],states:[],cities:[],role_id:null,role:null,state:null,city_id:null,city:null,city_request_data:{filter_state:null},options_size:parseInt("5000"),user_data:this.$cookies.get("user-data")}},methods:{getUser(){g.post(`/user/show/${this.user_data.id}`,{},{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{let t=e.data.data;this.formState.first_name=t.first_name,this.formState.last_name=t.last_name,this.formState.email=t.email,this.formState.phone=t.phone,this.formState.address1=t.address1,this.formState.address2=t.address2,this.formState.zip=t.zip,this.formState.state=t.state,this.formState.role_id=this.role_id=t.role_id,this.formState.role=this.role=t.role,this.formState.city_id=this.city_id=t.city_id,this.formState.city=this.city=t.city,this.state=t.state,this.getRoles(),this.getStates(),this.getCities(!1)}).catch(e=>{console.error(e),f.error(e.response.data.message)})},getRoles(){let e={per_page:this.options_size};g.post("/role",e,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(t=>{this.roles=t.data.data}).catch(t=>{console.error(t.response.data.message),this.roles=[]})},getStates(){let e={per_page:this.options_size};g.post("/state",e,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(t=>{this.states=t.data.data}).catch(t=>{console.error(t.response.data.message)})},getCities(e){let t={per_page:this.options_size};e&&(t.filter_state=this.city_request_data.filter_state),g.post("/city",t,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(u=>{this.cities=u.data.data}).catch(u=>{console.error(u.response.data.message)})},submit(){this.loading=!0,g.post(`/user/update/${this.user_data.id}`,C(this.formState),{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{f.success(e.data.message),this.loading=!1}).catch(e=>{console.error(e),f.error(e.response.data.message),this.loading=!1})},filterOptions(e,t){var u;return((u=t==null?void 0:t.label)!=null?u:null).toLowerCase().includes(e.toLowerCase())},handleRoleChange(e){this.formState.role_id=e.value,this.formState.role=e.label},handleStateChange(e){this.formState.state=e.value,this.city_id=null,this.city_request_data.filter_state=e.value,this.getCities(!0)},handleCityChange(e){this.formState.city_id=e.value,this.formState.city=e.label}},mounted(){this.getUser()}});function E(e,t,u,y,w,m){const n=o("a-input"),r=o("a-form-item"),i=o("a-col"),d=o("a-row"),c=o("a-select"),h=o("a-button"),p=o("a-form");return _(),$("div",null,[a(p,{layout:"vertical",model:e.formState},{default:s(()=>[a(d,{gutter:24},{default:s(()=>[a(i,{span:12},{default:s(()=>[a(r,{label:"First Name",name:"first_name",rules:[{required:!0,message:"Please input your first name."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(n,{value:e.formState.first_name,"onUpdate:value":t[0]||(t[0]=l=>e.formState.first_name=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),a(i,{span:12},{default:s(()=>[a(r,{label:"Last Name",name:"last_name",rules:[{required:!0,message:"Please input your last name."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(n,{value:e.formState.last_name,"onUpdate:value":t[1]||(t[1]=l=>e.formState.last_name=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,{label:"Email Address",name:"email",rules:[{required:!0,message:"Please input your email."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(n,{value:e.formState.email,"onUpdate:value":t[2]||(t[2]=l=>e.formState.email=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:8},{default:s(()=>[a(r,{label:"State",name:"state","wrapper-col":{offset:2,pull:2},"has-feedback":"",rules:[{required:!0,message:"Please select your state."}]},{default:s(()=>[a(c,{placeholder:"Select Type",value:e.state,"onUpdate:value":t[3]||(t[3]=l=>e.state=l),showSearch:"",optionFilterProp:"children",options:e.states,filterOption:e.filterOptions,"label-in-value":"",onChange:e.handleStateChange},null,8,["value","options","filterOption","onChange"])]),_:1},8,["rules"])]),_:1}),a(i,{span:8},{default:s(()=>[a(r,{label:"City",name:"city_id","wrapper-col":{offset:2,pull:2},"has-feedback":"",rules:[{required:!0,message:"Please select your city."}]},{default:s(()=>[a(c,{placeholder:"Select Type",value:e.city_id,"onUpdate:value":t[4]||(t[4]=l=>e.city_id=l),showSearch:"",optionFilterProp:"children",options:e.cities,filterOption:e.filterOptions,"label-in-value":"",onChange:e.handleCityChange},null,8,["value","options","filterOption","onChange"])]),_:1},8,["rules"])]),_:1}),a(i,{span:8},{default:s(()=>[a(r,{label:"Zip",name:"zip",rules:[{required:!0,message:"Please input your zip."}]},{default:s(()=>[a(n,{value:e.formState.zip,"onUpdate:value":t[5]||(t[5]=l=>e.formState.zip=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,{label:"Address1",name:"address1",rules:[{required:!0,message:"Please input your address 1."}]},{default:s(()=>[a(n,{value:e.formState.address1,"onUpdate:value":t[6]||(t[6]=l=>e.formState.address1=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,{label:"Address2",ame:"address2",rules:[{required:!0,message:"Please input your address 2."}]},{default:s(()=>[a(n,{value:e.formState.address2,"onUpdate:value":t[7]||(t[7]=l=>e.formState.address2=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:12},{default:s(()=>[a(r,{label:"Phone Number",name:"phone",rules:[{required:!0,message:"Please input your phone."}]},{default:s(()=>[a(n,{value:e.formState.phone,"onUpdate:value":t[8]||(t[8]=l=>e.formState.phone=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),a(i,{span:12},{default:s(()=>[a(r,{label:"Role",name:"role",rules:[{required:!0,message:"Please select your role."}]},{default:s(()=>[a(c,{placeholder:"Select Role",value:e.role_id,"onUpdate:value":t[9]||(t[9]=l=>e.role_id=l),showSearch:"",optionFilterProp:"children",options:e.roles,filterOption:e.filterOptions,"label-in-value":"",onChange:e.handleRoleChange},null,8,["value","options","filterOption","onChange"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,null,{default:s(()=>[a(h,{key:"submit",type:"primary","html-type":"submit",loading:e.loading,disabled:e.loading,onClick:e.submit},{default:s(()=>[z("Update")]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}const D=P(j,[["render",E]]),J=U({setup(){const e=v(!1);return{formState:k({current_password:null,new_password:null,new_password_confirmation:null}),loading:e}},methods:{recheckInputs(){this.formState.new_password!==this.formState.new_password_confirmation?f.error("The new password and confirmation password should match."):this.submit()},submit(){this.loading=!0,g.post("/change-password",C(this.formState),{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{f.success(e.data.message),this.loading=!1}).catch(e=>{f.error(e.response.data.message),this.loading=!1})}}});function G(e,t,u,y,w,m){const n=o("a-input-password"),r=o("a-form-item"),i=o("a-col"),d=o("a-row"),c=o("a-button"),h=o("a-form");return _(),$("div",null,[a(h,{layout:"vertical",model:e.formState},{default:s(()=>[a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,{label:"Current Password",name:"current_password",rules:[{required:!0,message:"Please input your current password."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(n,{value:e.formState.current_password,"onUpdate:value":t[0]||(t[0]=p=>e.formState.current_password=p)},null,8,["value"])]),_:1},8,["rules"]),a(r,{label:"New Password",name:"new_password",rules:[{required:!0,message:"Please input your new password."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(n,{value:e.formState.new_password,"onUpdate:value":t[1]||(t[1]=p=>e.formState.new_password=p)},null,8,["value"])]),_:1},8,["rules"]),a(r,{label:"Re-type New Password",name:"new_password_confirmation",dependencies:["new_password"],rules:[{required:!0,message:"Please input your password confirmation."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(n,{value:e.formState.new_password_confirmation,"onUpdate:value":t[2]||(t[2]=p=>e.formState.new_password_confirmation=p)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(i,{span:24},{default:s(()=>[a(r,null,{default:s(()=>[a(c,{type:"primary","html-type":"submit",loading:e.loading,disabled:e.loading,onClick:t[3]||(t[3]=p=>e.recheckInputs())},{default:s(()=>[z("Update New Password")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}const Y=P(J,[["render",G]]);const Z=U({components:{AdminLayout:L,UserAvatar:T,UserInformation:D,UserPassword:Y},data(){return{title:"My Profile",activeKey:v("1")}}}),H={class:"view-container"};function Q(e,t,u,y,w,m){const n=o("UserAvatar"),r=o("a-col"),i=o("UserInformation"),d=o("a-card"),c=o("a-row"),h=o("a-tab-pane"),p=o("UserPassword"),l=o("a-tabs"),A=o("AdminLayout");return _(),S(A,{defaultKey:"0"},{default:s(()=>[b("h1",null,[b("span",null,M(e.title),1)]),b("div",H,[a(l,{activeKey:e.activeKey,"onUpdate:activeKey":t[0]||(t[0]=q=>e.activeKey=q),size:"large"},{default:s(()=>[a(h,{key:"1",tab:"Profile"},{default:s(()=>[a(c,{gutter:48},{default:s(()=>[a(r,{span:8},{default:s(()=>[a(n)]),_:1}),a(r,{span:16},{default:s(()=>[a(d,{title:"Personal Information",style:{width:"800px"}},{default:s(()=>[a(i)]),_:1})]),_:1})]),_:1})]),_:1}),a(h,{key:"2",tab:"Password"},{default:s(()=>[a(d,{title:"Password",style:{width:"600px"}},{default:s(()=>[a(p)]),_:1})]),_:1})]),_:1},8,["activeKey"])])]),_:1})}const x=P(Z,[["render",Q],["__scopeId","data-v-b0f81407"]]);export{x as default};
