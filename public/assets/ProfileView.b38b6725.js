import{A as q}from"./AdminLayout.6e1876d9.js";import{d as $,L,P as B,r as g,j as h,m as f,_ as P,f as r,o as y,a as S,c as a,w as s,h as O,k as U,e as w,F as I,q as k,s as C,g as M,t as N}from"./index.11151275.js";function F(e){return new Promise((t,n)=>{const m=new FileReader;m.readAsDataURL(e),m.onload=()=>t(m.result),m.onerror=v=>n(v)})}const T=$({components:{LoadingOutlined:L,PlusOutlined:B},setup(){const e=g(!1),t=g(!1),n=g(""),m=g("");return{loading:e,handleCancel:()=>{t.value=!1,m.value=""},handlePreview:async o=>{!o.url&&!o.preview&&(o.preview=await F(o.originFileObj)),n.value=o.url||o.preview,t.value=!0,m.value=o.name||o.url.substring(o.url.lastIndexOf("/")+1)},beforeUpload:o=>{const l=o.type==="image/jpeg"||o.type==="image/png";l||f.error("You can only upload JPG file!");const d=o.size/1024/1024<2;return d||f.error("Image must smaller than 2MB!"),l&&d},previewVisible:t,previewImage:n,previewTitle:m}},data(){return{base_url:"http://beta-api-igo.talentbuilders.org/api/v1/",user_data:this.$cookies.get("user-data"),fileList:[],imageUrl:null}},methods:{handleChange(e){console.log(this.fileList),e.file.status==="uploading"&&(this.imageUrl=e.file.originFileObj)},getUser(){h.post(`/user/show/${this.user_data.id}`,{},{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{let n=e.data.data.picture;this.fileList.push({uid:"1",name:n.replace(this.base_url.replace("api/v1/","")+"storage/profile_pics/",""),status:"done",url:n})}).catch(e=>{console.error(e)})},submit(){this.loading=!0;let e=new FormData;e.append("picture",this.imageUrl),h.post("/auth/update-user-profile-pic",e,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(t=>{f.success(t.data.message),this.loading=!1}).catch(t=>{console.error(t),f.error(t.response.data.message),this.loading=!1})}},mounted(){this.getUser()}}),V={key:0},K=w("div",{style:{"margin-top":"8px"}},"Upload",-1),R=["src"];function j(e,t,n,m,v,b){const u=r("plus-outlined"),o=r("a-upload"),l=r("a-button"),d=r("a-col"),c=r("a-row"),_=r("a-modal");return y(),S(I,null,[a(o,{"file-list":e.fileList,"onUpdate:file-list":t[0]||(t[0]=p=>e.fileList=p),"list-type":"picture-card",onPreview:e.handlePreview,onChange:e.handleChange},{default:s(()=>[e.fileList.length<1?(y(),S("div",V,[a(u),K])):O("",!0)]),_:1},8,["file-list","onPreview","onChange"]),a(c,{class:"mt-4"},{default:s(()=>[a(d,null,{default:s(()=>[a(l,{key:"submit",type:"primary","html-type":"submit",loading:e.loading,disabled:e.loading,onClick:e.submit},{default:s(()=>[U("Update")]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1}),a(_,{visible:e.previewVisible,title:e.previewTitle,footer:null,onCancel:e.handleCancel},{default:s(()=>[w("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,R)]),_:1},8,["visible","title","onCancel"])],64)}const D=P(T,[["render",j]]),E=$({setup(){const e=g(!1);return{formState:k({client_id:0,first_name:null,last_name:null,email:null,city:null,state:null,zip:null,address1:null,address2:null,phone:null}),loading:e}},data(){return{states:[],cities:[],state:null,city_id:null,city:null,city_request_data:{filter_state:null},options_size:parseInt("5000"),current_route:this.$router.currentRoute.value,user_data:this.$cookies.get("user-data")}},methods:{getUser(){h.post(`/user/show/${this.user_data.id}`,{},{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{let t=e.data.data;this.formState.first_name=t.first_name,this.formState.last_name=t.last_name,this.formState.email=t.email,this.formState.phone=t.phone,this.formState.address1=t.address1,this.formState.address2=t.address2,this.formState.zip=t.zip,this.formState.state=t.state,this.formState.city_id=this.city_id=t.city_id,this.formState.city=this.city=t.city,this.state=t.state,this.getStates(),this.getCities(!1)}).catch(e=>{console.error(e),f.error(e.response.data.message)})},getStates(){let e={per_page:this.options_size};h.post("/state",e,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(t=>{this.states=t.data.data}).catch(t=>{console.error(t.response.data.message)})},getCities(e){let t={per_page:this.options_size};e&&(t.filter_state=this.city_request_data.filter_state),h.post("/city",t,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(n=>{this.cities=n.data.data}).catch(n=>{console.error(n.response.data.message)})},submit(){this.loading=!0,this.createAuditTrail("Clicked on the update profile button."),h.post("/update-user-profile",C(this.formState),{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{f.success(e.data.message),this.loading=!1}).catch(e=>{console.error(e),f.error(e.response.data.message),this.loading=!1})},filterOptions(e,t){var n;return((n=t==null?void 0:t.label)!=null?n:null).toLowerCase().includes(e.toLowerCase())},handleStateChange(e){this.formState.state=e.value,this.city_id=null,this.city_request_data.filter_state=e.value,this.getCities(!0)},handleCityChange(e){this.formState.city_id=e.value,this.formState.city=e.label},createAuditTrail(e){let t={user_id:this.user_data.id,pages:this.current_route.fullPath,activity:e};h.post("/audit-trail/store",t,{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(n=>{console.log(n.data.message)}).catch(n=>{console.error(n.response.data.message)})}},mounted(){this.getUser()}});function J(e,t,n,m,v,b){const u=r("a-input"),o=r("a-form-item"),l=r("a-col"),d=r("a-row"),c=r("a-select"),_=r("a-button"),p=r("a-form");return y(),S("div",null,[a(p,{layout:"vertical",model:e.formState},{default:s(()=>[a(d,{gutter:24},{default:s(()=>[a(l,{span:12},{default:s(()=>[a(o,{label:"First Name",name:"first_name",rules:[{required:!0,message:"Please input your first name."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(u,{value:e.formState.first_name,"onUpdate:value":t[0]||(t[0]=i=>e.formState.first_name=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),a(l,{span:12},{default:s(()=>[a(o,{label:"Last Name",name:"last_name",rules:[{required:!0,message:"Please input your last name."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(u,{value:e.formState.last_name,"onUpdate:value":t[1]||(t[1]=i=>e.formState.last_name=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:12},{default:s(()=>[a(o,{label:"Email Address",name:"email",rules:[{required:!0,message:"Please input your email."},{max:100,message:"Maximum of 100 characters."}]},{default:s(()=>[a(u,{value:e.formState.email,"onUpdate:value":t[2]||(t[2]=i=>e.formState.email=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),a(l,{span:12},{default:s(()=>[a(o,{label:"Phone Number",name:"phone",rules:[{required:!0,message:"Please input your phone."}]},{default:s(()=>[a(u,{value:e.formState.phone,"onUpdate:value":t[3]||(t[3]=i=>e.formState.phone=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:8},{default:s(()=>[a(o,{label:"State",name:"state","has-feedback":"",rules:[{required:!0,message:"Please select your state."}]},{default:s(()=>[a(c,{placeholder:"Select Type",value:e.state,"onUpdate:value":t[4]||(t[4]=i=>e.state=i),showSearch:"",optionFilterProp:"children",options:e.states,filterOption:e.filterOptions,"label-in-value":"",onChange:e.handleStateChange},null,8,["value","options","filterOption","onChange"])]),_:1},8,["rules"])]),_:1}),a(l,{span:8},{default:s(()=>[a(o,{label:"City",name:"city_id","has-feedback":"",rules:[{required:!0,message:"Please select your city."}]},{default:s(()=>[a(c,{placeholder:"Select Type",value:e.city_id,"onUpdate:value":t[5]||(t[5]=i=>e.city_id=i),showSearch:"",optionFilterProp:"children",options:e.cities,filterOption:e.filterOptions,"label-in-value":"",onChange:e.handleCityChange},null,8,["value","options","filterOption","onChange"])]),_:1},8,["rules"])]),_:1}),a(l,{span:8},{default:s(()=>[a(o,{label:"Zip",name:"zip",rules:[{required:!0,message:"Please input your zip."}]},{default:s(()=>[a(u,{value:e.formState.zip,"onUpdate:value":t[6]||(t[6]=i=>e.formState.zip=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:24},{default:s(()=>[a(o,{label:"Address1",name:"address1",rules:[{required:!0,message:"Please input your address 1."}]},{default:s(()=>[a(u,{value:e.formState.address1,"onUpdate:value":t[7]||(t[7]=i=>e.formState.address1=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:24},{default:s(()=>[a(o,{label:"Address2",ame:"address2",rules:[{required:!0,message:"Please input your address 2."}]},{default:s(()=>[a(u,{value:e.formState.address2,"onUpdate:value":t[8]||(t[8]=i=>e.formState.address2=i)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:24},{default:s(()=>[a(o,null,{default:s(()=>[a(_,{key:"submit",type:"primary","html-type":"submit",loading:e.loading,disabled:e.loading,onClick:e.submit},{default:s(()=>[U("Update")]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}const G=P(E,[["render",J]]),Y=$({setup(){const e=g(!1);return{formState:k({current_password:null,new_password:null,new_password_confirmation:null}),loading:e}},methods:{recheckInputs(){this.formState.new_password!==this.formState.new_password_confirmation?f.error("The new password and confirmation password should match."):this.submit()},submit(){this.loading=!0,h.post("/auth/change-password",C(this.formState),{headers:{Authorization:`Bearer ${this.$cookies.get("igo-x-access-token")}`}}).then(e=>{f.success(e.data.message),this.loading=!1}).catch(e=>{f.error(e.response.data.message),this.loading=!1})}}});function Z(e,t,n,m,v,b){const u=r("a-input-password"),o=r("a-form-item"),l=r("a-col"),d=r("a-row"),c=r("a-button"),_=r("a-form");return y(),S("div",null,[a(_,{layout:"vertical",model:e.formState},{default:s(()=>[a(d,{gutter:24},{default:s(()=>[a(l,{span:24},{default:s(()=>[a(o,{label:"Current Password",name:"current_password",rules:[{required:!0,message:"Please input your current password."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(u,{value:e.formState.current_password,"onUpdate:value":t[0]||(t[0]=p=>e.formState.current_password=p)},null,8,["value"])]),_:1},8,["rules"]),a(o,{label:"New Password",name:"new_password",rules:[{required:!0,message:"Please input your new password."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(u,{value:e.formState.new_password,"onUpdate:value":t[1]||(t[1]=p=>e.formState.new_password=p)},null,8,["value"])]),_:1},8,["rules"]),a(o,{label:"Re-type New Password",name:"new_password_confirmation",dependencies:["new_password"],rules:[{required:!0,message:"Please input your password confirmation."},{min:8,message:"Minimum of 8 characters."},{max:255,message:"Maximum of 255 characters."}]},{default:s(()=>[a(u,{value:e.formState.new_password_confirmation,"onUpdate:value":t[2]||(t[2]=p=>e.formState.new_password_confirmation=p)},null,8,["value"])]),_:1},8,["rules"])]),_:1})]),_:1}),a(d,{gutter:24},{default:s(()=>[a(l,{span:24},{default:s(()=>[a(o,null,{default:s(()=>[a(c,{type:"primary","html-type":"submit",loading:e.loading,disabled:e.loading,onClick:t[3]||(t[3]=p=>e.recheckInputs())},{default:s(()=>[U("Update New Password")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}const H=P(Y,[["render",Z]]);const Q=$({components:{AdminLayout:q,UserAvatar:D,UserInformation:G,UserPassword:H},data(){return{title:"My Profile",activeKey:g("1")}}}),W={class:"view-container"};function X(e,t,n,m,v,b){const u=r("UserAvatar"),o=r("a-card"),l=r("a-col"),d=r("UserInformation"),c=r("a-row"),_=r("a-tab-pane"),p=r("UserPassword"),i=r("a-tabs"),A=r("AdminLayout");return y(),M(A,{defaultKey:"0"},{default:s(()=>[w("h1",null,[w("span",null,N(e.title),1)]),w("div",W,[a(i,{activeKey:e.activeKey,"onUpdate:activeKey":t[0]||(t[0]=z=>e.activeKey=z),size:"large"},{default:s(()=>[a(_,{key:"1",tab:"Profile"},{default:s(()=>[a(c,{gutter:24},{default:s(()=>[a(l,{span:8},{default:s(()=>[a(o,{title:"Profile Picture"},{default:s(()=>[a(u)]),_:1})]),_:1}),a(l,{span:16},{default:s(()=>[a(o,{title:"Personal Information",style:{width:"800px"}},{default:s(()=>[a(d)]),_:1})]),_:1})]),_:1})]),_:1}),a(_,{key:"2",tab:"Password"},{default:s(()=>[a(o,{title:"Password",style:{width:"600px"}},{default:s(()=>[a(p)]),_:1})]),_:1})]),_:1},8,["activeKey"])])]),_:1})}const te=P(Q,[["render",X],["__scopeId","data-v-4bf3c7d5"]]);export{te as default};
